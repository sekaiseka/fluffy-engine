// 状態変数（各ボタンのON/OFF状態）
let scarfActive = false, selfWeatherActive = false, selfParalyzeActive = false;
let enemyWeatherActive = false, enemyParalyzeActive = false;
let selfRank = 0, enemyRank = 0;

// ポケモンデータ（基本素早さ）
let pokemonData = {
    "フシギダネ": 45,
    "フシギソウ": 60,
    "フシギバナ": 80,
    "ヒトカゲ": 65,
    "リザード": 80,
    "リザードン": 100,
    "ゼニガメ": 43,
    "カメール": 58,
    "カメックス": 78,
    "アーボ": 55,
    "アーボック": 80,
    "ピカチュウ": 90,
    "ライチュウ": 110,
    "ライチュウ\n(アローラのすがた)": 110,
    "サンド": 40,
    "サンド\n(アローラのすがた)": 40,
    "サンドパン": 65,
    "サンドパン\n(アローラのすがた)": 65,
    "ピッピ": 35,
    "ピクシー": 60,
    "ロコン": 65,
    "ロコン\n(アローラのすがた)": 65,
    "キュウコン": 100,
    "キュウコン\n(アローラのすがた)": 109,
    "プリン": 20,
    "プクリン": 45,
    "ナゾノクサ": 30,
    "クサイハナ": 40,
    "ラフレシア": 50,
    "コンパン": 45,
    "モルフォン": 90,
    "ディグダ": 95,
    "ディグダ\n(アローラのすがた)": 90,
    "ダグトリオ": 120,
    "ダグトリオ\n(アローラのすがた)": 110,
    "ニャース": 90,
    "ニャース\n(アローラのすがた)": 90,
    "ニャース\n(ガラルのすがた)": 40,
    "ペルシアン": 115,
    "ペルシアン\n(アローラのすがた)": 115,
    "コダック": 55,
    "ゴルダック": 85,
    "マンキー": 70,
    "オコリザル": 95,
    "ガーディ": 60,
    "ガーディ\n(ヒスイのすがた)": 55,
    "ウインディ": 95,
    "ウインディ\n(ヒスイのすがた)": 90,
    "ニョロモ": 90,
    "ニョロゾ": 90,
    "ニョロボン": 70,
    "マダツボミ": 40,
    "ウツドン": 55,
    "ウツボット": 70,
    "メノクラゲ": 70,
    "ドククラゲ": 100,
    "イシツブテ": 20,
    "イシツブテ\n(アローラのすがた)": 20,
    "ゴローン": 35,
    "ゴローン\n(アローラのすがた)": 35,
    "ゴローニャ": 45,
    "ゴローニャ\n(アローラのすがた)": 45,
    "ヤドン": 15,
    "ヤドン\n(ガラルのすがた)": 15,
    "ヤドラン": 30,
    "ヤドラン\n(ガラルのすがた)": 30,
    "コイル": 45,
    "レアコイル": 70,
    "ドードー": 75,
    "ドードリオ": 110,
    "パウワウ": 45,
    "ジュゴン": 70,
    "ベトベター": 25,
    "ベトベター\n(アローラのすがた)": 25,
    "ベトベトン": 50,
    "ベトベトン\n(アローラのすがた)": 50,
    "シェルダー": 40,
    "パルシェン": 70,
    "ゴース": 80,
    "ゴースト": 95,
    "ゲンガー": 110,
    "スリープ": 42,
    "スリーパー": 67,
    "ビリリダマ": 100,
    "ビリリダマ\n(ヒスイのすがた)": 100,
    "マルマイン": 150,
    "マルマイン\n(ヒスイのすがた)": 150,
    "タマタマ": 40,
    "ナッシー": 55,
    "ナッシー\n(アローラのすがた)": 45,
    "サワムラー": 87,
    "エビワラー": 76,
    "ドガース": 35,
    "マタドガス": 60,
    "マタドガス\n(ガラルのすがた)": 60,
    "サイホーン": 25,
    "サイドン": 40,
    "ラッキー": 50,
    "タッツー": 60,
    "シードラ": 85,
    "ストライク": 105,
    "エレブー": 105,
    "ブーバー": 93,
    "ケンタロス": 110,
    "ケンタロス\n(パルデアのすがた・コンバット種)": 100,
    "ケンタロス\n(パルデアのすがた・ブレイズ種)": 100,
    "ケンタロス\n(パルデアのすがた・ウォーター種)": 100,
    "コイキング": 80,
    "ギャラドス": 81,
    "ラプラス": 60,
    "メタモン": 48,
    "イーブイ": 55,
    "シャワーズ": 65,
    "サンダース": 130,
    "ブースター": 65,
    "ポリゴン": 40,
    "カビゴン": 30,
    "フリーザー": 85,
    "フリーザー\n(ガラルのすがた)": 95,
    "サンダー": 100,
    "サンダー\n(ガラルのすがた)": 100,
    "ファイヤー": 90,
    "ファイヤー\n(ガラルのすがた)": 90,
    "ミニリュウ": 50,
    "ハクリュー": 70,
    "カイリュー": 80,
    "ミュウツー": 130,
    "ミュウ": 100,
    "チコリータ": 45,
    "ベイリーフ": 60,
    "メガニウム": 80,
    "ヒノアラシ": 65,
    "マグマラシ": 80,
    "バクフーン": 100,
    "バクフーン\n(ヒスイのすがた)": 95,
    "ワニノコ": 43,
    "アリゲイツ": 58,
    "オーダイル": 78,
    "オタチ": 20,
    "オオタチ": 90,
    "ホーホー": 50,
    "ヨルノズク": 70,
    "イトマル": 30,
    "アリアドス": 40,
    "チョンチー": 67,
    "ランターン": 67,
    "ピチュー": 60,
    "ピィ": 15,
    "ププリン": 15,
    "メリープ": 35,
    "モココ": 45,
    "デンリュウ": 55,
    "マリル": 40,
    "マリルリ": 50,
    "ウソッキー": 30,
    "ニョロトノ": 70,
    "ハネッコ": 50,
    "ポポッコ": 80,
    "ワタッコ": 110,
    "エイパム": 85,
    "ヒマナッツ": 30,
    "キマワリ": 30,
    "ヤンヤンマ": 95,
    "ウパー": 15,
    "ウパー\n(パルデアのすがた)": 15,
    "ヌオー": 35,
    "エーフィ": 110,
    "ブラッキー": 65,
    "ヤミカラス": 91,
    "ヤドキング": 30,
    "ヤドキング\n(ガラルのすがた)": 30,
    "ムウマ": 85,
    "キリンリキ": 85,
    "クヌギダマ": 15,
    "フォレトス": 40,
    "ノコッチ": 45,
    "グライガー": 85,
    "ブルー": 30,
    "グランブル": 45,
    "ハリーセン": 85,
    "ハリーセン\n(ヒスイのすがた)": 85,
    "ハッサム": 65,
    "ヘラクロス": 85,
    "ニューラ": 115,
    "ニューラ\n(ヒスイのすがた)": 115,
    "ヒメグマ": 40,
    "リングマ": 55,
    "マグマッグ": 20,
    "マグカルゴ": 30,
    "ウリムー": 50,
    "イノムー": 50,
    "デリバード": 75,
    "エアームド": 70,
    "デルビル": 65,
    "ヘルガー": 95,
    "キングドラ": 85,
    "ゴマゾウ": 40,
    "ドンファン": 50,
    "ポリゴン2": 60,
    "オドシシ": 85,
    "ドーブル": 75,
    "バルキー": 35,
    "カポエラー": 70,
    "エレキッド": 95,
    "ブビィ": 83,
    "ハピナス": 55,
    "ライコウ": 115,
    "エンテイ": 100,
    "スイクン": 85,
    "ヨーギラス": 41,
    "サナギラス": 51,
    "バンギラス": 61,
    "ルギア": 110,
    "ホウオウ": 90,
    "キモリ": 70,
    "ジュプトル": 95,
    "ジュカイン": 120,
    "アチャモ": 45,
    "ワカシャモ": 55,
    "バシャーモ": 80,
    "ミズゴロウ": 40,
    "ヌマクロー": 50,
    "ラグラージ": 60,
    "ポチエナ": 35,
    "グラエナ": 70,
    "ハスボー": 30,
    "ハスブレロ": 50,
    "ルンパッパ": 70,
    "タネボー": 30,
    "コノハナ": 60,
    "ダーテング": 80,
    "キャモメ": 85,
    "ペリッパー": 65,
    "ラルトス": 40,
    "キルリア": 50,
    "サーナイト": 80,
    "アメタマ": 65,
    "アメモース": 80,
    "キノココ": 35,
    "キノガッサ": 70,
    "ナマケロ": 30,
    "ヤルキモノ": 90,
    "ケッキング": 100,
    "マクノシタ": 25,
    "ハリテヤマ": 50,
    "ルリリ": 20,
    "ノズパス": 30,
    "ヤミラミ": 50,
    "アサナン": 60,
    "チャーレム": 80,
    "プラスル": 95,
    "マイナン": 95,
    "バルビート": 85,
    "イルミーゼ": 85,
    "ゴクリン": 40,
    "マルノーム": 55,
    "ドンメル": 35,
    "バクーダ": 40,
    "コータス": 20,
    "バネブー": 60,
    "ブーピッグ": 80,
    "ナックラー": 10,
    "ビブラーバ": 70,
    "フライゴン": 100,
    "サボネア": 35,
    "ノクタス": 55,
    "チルット": 50,
    "チルタリス": 80,
    "ザングース": 90,
    "ハブネーク": 65,
    "ドジョッチ": 60,
    "ナマズン": 60,
    "ヘイガニ": 35,
    "シザリガー": 55,
    "ヒンバス": 80,
    "ミロカロス": 81,
    "カゲボウズ": 45,
    "ジュペッタ": 65,
    "ヨマワル": 25,
    "サマヨール": 25,
    "トロピウス": 51,
    "チリーン": 65,
    "ユキワラシ": 50,
    "オニゴーリ": 80,
    "ラブカス": 97,
    "タツベイ": 50,
    "コモルー": 50,
    "ボーマンダ": 100,
    "ダンバル": 30,
    "メタング": 50,
    "メタグロス": 70,
    "レジロック": 50,
    "レジアイス": 50,
    "レジスチル": 50,
    "ラティアス": 110,
    "ラティオス": 110,
    "カイオーガ": 90,
    "グラードン": 90,
    "レックウザ": 95,
    "ジラーチ": 100,
    "デオキシス\n(ノーマルフォルム)": 150,
    "デオキシス\n(アタックフォルム)": 150,
    "デオキシス\n(ディフェンスフォルム)": 90,
    "デオキシス\n(スピードフォルム)": 180,
    "ナエトル": 31,
    "ハヤシガメ": 36,
    "ドダイトス": 56,
    "ヒコザル": 61,
    "モウカザル": 81,
    "ゴウカザル": 108,
    "ポッチャマ": 40,
    "ポッタイシ": 50,
    "エンペルト": 60,
    "ムックル": 60,
    "ムクバード": 80,
    "ムクホーク": 100,
    "コロボーシ": 25,
    "コロトック": 65,
    "コリンク": 45,
    "ルクシオ": 60,
    "レントラー": 70,
    "ズガイドス": 58,
    "ラムパルド": 58,
    "タテトプス": 30,
    "トリデプス": 30,
    "ミツハニー": 70,
    "ビークイン": 40,
    "パチリス": 95,
    "ブイゼル": 85,
    "フローゼル": 115,
    "カラナクシ\n(にしのうみ)": 34,
    "カラナクシ\n(ひがしのうみ)": 34,
    "トリトドン\n(にしのうみ)": 39,
    "トリトドン\n(ひがしのうみ)": 39,
    "エテボース": 115,
    "フワンテ": 70,
    "フワライド": 80,
    "ムウマージ": 105,
    "ドンカラス": 71,
    "リーシャン": 45,
    "スカンプー": 74,
    "スカタンク": 84,
    "ドーミラー": 23,
    "ドータクン": 33,
    "ウソハチ": 10,
    "ピンプク": 30,
    "ミカルゲ": 35,
    "フカマル": 42,
    "ガバイト": 82,
    "ガブリアス": 102,
    "ゴンベ": 5,
    "リオル": 60,
    "ルカリオ": 90,
    "ヒポポタス": 32,
    "カバルドン": 47,
    "グレッグル": 50,
    "ドクロッグ": 85,
    "ケイコウオ": 66,
    "ネオラント": 91,
    "ユキカブリ": 40,
    "ユキノオー": 60,
    "マニューラ": 125,
    "ジバコイル": 60,
    "ドサイドン": 40,
    "エレキブル": 95,
    "ブーバーン": 83,
    "メガヤンマ": 95,
    "リーフィア": 95,
    "グレイシア": 65,
    "グライオン": 95,
    "マンムー": 80,
    "ポリゴンZ": 90,
    "エルレイド": 80,
    "ダイノーズ": 40,
    "ヨノワール": 45,
    "ユキメノコ": 110,
    "ロトム": 91,
    "ロトム\n(ヒートロトム)": 86,
    "ロトム\n(ウォッシュロトム)": 86,
    "ロトム\n(フロストロトム)": 86,
    "ロトム\n(スピンロトム)": 86,
    "ロトム\n(カットロトム)": 86,
    "ユクシー": 95,
    "エムリット": 80,
    "アグノム": 115,
    "ディアルガ": 90,
    "ディアルガ\n(オリジンフォルム)": 90,
    "パルキア": 100,
    "パルキア\n(オリジンフォルム)": 120,
    "ヒードラン": 77,
    "レジギガス": 100,
    "ギラティナ\n(アナザーフォルム)": 90,
    "ギラティナ\n(オリジンフォルム)": 90,
    "クレセリア": 85,
    "フィオネ": 80,
    "マナフィ": 100,
    "ダークライ": 125,
    "シェイミ\n(ランドフォルム)": 100,
    "シェイミ\n(スカイフォルム)": 127,
    "アルセウス": 120,
    "ツタージャ": 63,
    "ジャノビー": 83,
    "ジャローダ": 113,
    "ポカブ": 45,
    "チャオブー": 55,
    "エンブオー": 65,
    "ミジュマル": 45,
    "フタチマル": 60,
    "ダイケンキ": 70,
    "ダイケンキ\n(ヒスイのすがた)": 85,
    "シママ": 76,
    "ゼブライカ": 116,
    "モグリュー": 68,
    "ドリュウズ": 88,
    "ドッコラー": 35,
    "ドテッコツ": 40,
    "ローブシン": 45,
    "クルミル": 42,
    "クルマユ": 42,
    "ハハコモリ": 92,
    "モンメン": 66,
    "エルフーン": 116,
    "チュリネ": 30,
    "ドレディア": 90,
    "ドレディア\n(ヒスイのすがた)": 105,
    "バスラオ\n(あかすじのすがた)": 98,
    "バスラオ\n(あおすじのすがた)": 98,
    "バスラオ\n(しろすじのすがた)": 98,
    "メグロコ": 65,
    "ワルビル": 74,
    "ワルビアル": 92,
    "ズルッグ": 48,
    "ズルズキン": 58,
    "ゾロア": 65,
    "ゾロア\n(ヒスイのすがた)": 70,
    "ゾロアーク": 105,
    "ゾロアーク\n(ヒスイのすがた)": 110,
    "チラーミィ": 75,
    "チラチーノ": 115,
    "ゴチム": 45,
    "ゴチミル": 55,
    "ゴチルゼル": 65,
    "ユニラン": 20,
    "ダブラン": 30,
    "ランクルス": 30,
    "コアルヒー": 55,
    "スワンナ": 98,
    "シキジカ": 75,
    "メブキジカ": 95,
    "タマゲタケ": 15,
    "モロバレル": 30,
    "ママンボウ": 65,
    "バチュル": 65,
    "デンチュラ": 108,
    "シビシラス": 60,
    "シビビール": 40,
    "シビルドン": 50,
    "ヒトモシ": 20,
    "ランプラー": 55,
    "シャンデラ": 80,
    "キバゴ": 57,
    "オノンド": 67,
    "オノノクス": 97,
    "クマシュン": 40,
    "ツンベアー": 50,
    "フリージオ": 105,
    "コジョフー": 65,
    "コジョンド": 105,
    "ゴビット": 35,
    "ゴルーグ": 55,
    "コマタナ": 60,
    "キリキザン": 70,
    "ワシボン": 60,
    "ウォーグル": 80,
    "ウォーグル\n(ヒスイのすがた)": 65,
    "バルチャイ": 60,
    "バルジーナ": 80,
    "モノズ": 38,
    "ジヘッド": 58,
    "サザンドラ": 98,
    "メラルバ": 60,
    "ウルガモス": 100,
    "コバルオン": 108,
    "テラキオン": 108,
    "ビリジオン": 108,
    "トルネロス\n(けしんフォルム)": 111,
    "トルネロス\n(れいじゅうフォルム)": 121,
    "ボルトロス\n(けしんフォルム)": 111,
    "ボルトロス\n(れいじゅうフォルム)": 101,
    "レシラム": 90,
    "ゼクロム": 90,
    "ランドロス\n(けしんフォルム)": 101,
    "ランドロス\n(れいじゅうフォルム)": 91,
    "キュレム": 95,
    "キュレム\n(ホワイトキュレム)": 95,
    "キュレム\n(ブラックキュレム)": 95,
    "ケルディオ\n(いつものすがた)": 108,
    "ケルディオ\n(かくごのすがた)": 108,
    "メロエッタ\n(ボイスフォルム)": 90,
    "メロエッタ\n(ステップフォルム)": 128,
    "ハリマロン": 38,
    "ハリボーグ": 57,
    "ブリガロン": 64,
    "フォッコ": 60,
    "テールナー": 73,
    "マフォクシー": 104,
    "ケロマツ": 71,
    "ゲコガシラ": 97,
    "ゲッコウガ": 122,
    "ヤヤコマ": 62,
    "ヒノヤコマ": 84,
    "ファイアロー": 126,
    "コフキムシ": 35,
    "コフーライ": 29,
    "ビビヨン": 89,
    "シシコ": 72,
    "カエンジシ": 106,
    "フラベベ": 42,
    "フラエッテ": 52,
    "フラージェス": 75,
    "メェークル": 52,
    "ゴーゴート": 68,
    "ニャスパー": 68,
    "ニャオニクス": 104,
    "マーイーカ": 45,
    "カラマネロ": 73,
    "クズモー": 30,
    "ドラミドロ": 44,
    "ウデッポウ": 44,
    "ブロスター": 59,
    "ニンフィア": 60,
    "ルチャブル": 118,
    "デデンネ": 101,
    "メレシー": 50,
    "ヌメラ": 40,
    "ヌメイル": 60,
    "ヌメイル\n(ヒスイのすがた)": 40,
    "ヌメルゴン": 80,
    "ヌメルゴン\n(ヒスイのすがた)": 60,
    "クレッフィ": 75,
    "ボクレー": 38,
    "オーロット": 56,
    "カチコール": 28,
    "クレベース": 28,
    "クレベース\n(ヒスイのすがた)": 38,
    "オンバット": 55,
    "オンバーン": 123,
    "ディアンシー": 50,
    "フーパ\n(いましめられしすがた)": 70,
    "フーパ\n(ときはなたれしすがた)": 80,
    "ボルケニオン": 70,
    "モクロー": 42,
    "フクスロー": 52,
    "ジュナイパー": 70,
    "ジュナイパー\n(ヒスイのすがた)": 60,
    "ニャビー": 70,
    "ニャヒート": 90,
    "ガオガエン": 60,
    "アシマリ": 40,
    "オシャマリ": 50,
    "アシレーヌ": 60,
    "ツツケラ": 65,
    "ケララッパ": 75,
    "ドデカバシ": 60,
    "ヤングース": 45,
    "デカグース": 45,
    "アゴジムシ": 46,
    "デンヂムシ": 36,
    "クワガノン": 43,
    "マケンカニ": 63,
    "ケケンカニ": 43,
    "オドリドリ\n(めらめらスタイル)": 93,
    "オドリドリ\n(ぱちぱちスタイル)": 93,
    "オドリドリ\n(ふらふらスタイル)": 93,
    "オドリドリ\n(まいまいスタイル)": 93,
    "アブリー": 84,
    "アブリボン": 124,
    "イワンコ": 60,
    "ルガルガン\n(まひるのすがた)": 112,
    "ルガルガン\n(まよなかのすがた)": 82,
    "ルガルガン\n(たそがれのすがた)": 110,
    "ヒドイデ": 45,
    "ドヒドイデ": 35,
    "ドロバンコ": 45,
    "バンバドロ": 35,
    "シズクモ": 27,
    "オニシズクモ": 42,
    "カリキリ": 35,
    "ラランテス": 45,
    "ヤトウモリ": 77,
    "エンニュート": 117,
    "アマカジ": 32,
    "アママイコ": 62,
    "アマージョ": 72,
    "キュワワー": 100,
    "ヤレユータン": 60,
    "ナゲツケサル": 80,
    "スナバァ": 15,
    "シロデスナ": 35,
    "メテノ\n(りゅうせいのすがた)": 60,
    "メテノ\n(コアのすがた)": 120,
    "ネッコアラ": 65,
    "ミミッキュ": 96,
    "ハギギシリ": 92,
    "カプ・コケコ": 130,
    "カプ・テテフ": 95,
    "カプ・ブルル": 75,
    "カプ・レヒレ": 85,
    "コスモッグ": 37,
    "コスモウム": 37,
    "ソルガレオ": 97,
    "ルナアーラ": 97,
    "ネクロズマ": 79,
    "ネクロズマ\n(たそがれのたてがみ)": 77,
    "ネクロズマ\n(あかつきのつばさ)": 77,
    "マギアナ": 65,
    "サルノリ": 65,
    "バチンキー": 80,
    "ゴリランダー": 85,
    "ヒバニー": 69,
    "ラビフット": 94,
    "エースバーン": 119,
    "メッソン": 70,
    "ジメレオン": 90,
    "インテレオン": 120,
    "ホシガリス": 25,
    "ヨクバリス": 20,
    "ココガラ": 57,
    "アオガラス": 77,
    "アーマーガア": 67,
    "カムカメ": 44,
    "カジリガメ": 74,
    "タンドン": 30,
    "トロッゴン": 50,
    "セキタンザン": 30,
    "カジッチュ": 20,
    "アップリュー": 70,
    "タルップル": 30,
    "スナヘビ": 46,
    "サダイジャ": 71,
    "ウッウ": 85,
    "サシカマス": 66,
    "カマスジョー": 136,
    "エレズン": 40,
    "ストリンダー\n(ハイなすがた)": 75,
    "ストリンダー\n(ローなすがた)": 75,
    "ヤバチャ": 50,
    "ポットデス": 70,
    "ミブリム": 39,
    "テブリム": 49,
    "ブリムオン": 29,
    "ベロバー": 50,
    "ギモー": 70,
    "オーロンゲ": 60,
    "ニャイキング": 50,
    "マホミル": 34,
    "マホイップ": 64,
    "タイレーツ": 75,
    "バチンウニ": 15,
    "ユキハミ": 20,
    "モスノウ": 65,
    "イシヘンジン": 70,
    "コオリッポ\n(アイスフェイス)": 50,
    "コオリッポ\n(ナイスフェイス)": 130,
    "イエッサン♂": 95,
    "イエッサン♀": 85,
    "モルペコ": 97,
    "ゾウドウ": 40,
    "ダイオウドウ": 30,
    "ジュラルドン": 85,
    "ドラメシヤ": 82,
    "ドロンチ": 102,
    "ドラパルト": 142,
    "ザシアン": 138,
    "ザシアン\n(けんのおう)": 148,
    "ザマゼンタ": 138,
    "ザマゼンタ\n(たてのおう)": 128,
    "ムゲンダイナ": 130,
    "ダクマ": 72,
    "ウーラオス\n(いちげきのかた)": 97,
    "ウーラオス\n(れんげきのかた)": 97,
    "ザルード": 105,
    "レジエレキ": 200,
    "レジドラゴ": 80,
    "ブリザポス": 30,
    "レイスポス": 130,
    "バドレックス": 80,
    "バドレックス\n(はくばじょうのすがた)": 50,
    "バドレックス\n(こくばじょうのすがた)": 150,
    "アヤシシ": 65,
    "バサギリ": 85,
    "ガチグマ": 50,
    "イダイトウ♂": 78,
    "イダイトウ♀": 78,
    "オオニューラ": 120,
    "ハリーマン": 85,
    "ラブトロス\n(けしんフォルム)": 106,
    "ラブトロス\n(れいじゅうフォルム)": 46,
    "ニャオハ": 65,
    "ニャローテ": 83,
    "マスカーニャ": 123,
    "ホゲータ": 36,
    "アチゲータ": 49,
    "ラウドボーン": 66,
    "クワッス": 50,
    "ウェルカモ": 65,
    "ウェーニバル": 85,
    "グルトン": 35,
    "パフュートン♂": 65,
    "パフュートン♀": 65,
    "タマンチュラ": 20,
    "ワナイダー": 35,
    "マメバッタ": 45,
    "エクスレッグ": 92,
    "パモ": 60,
    "パモット": 85,
    "パーモット": 105,
    "ワッカネズミ": 75,
    "イッカネズミ": 111,
    "パピモッチ": 65,
    "バウッツェル": 95,
    "ミニーブ": 30,
    "オリーニョ": 33,
    "オリーヴァ": 39,
    "イキリンコ": 92,
    "コジオ": 25,
    "ジオヅム": 35,
    "キョジオーン": 35,
    "カルボウ": 35,
    "グレンアルマ": 75,
    "ソウブレイズ": 85,
    "ズピカ": 45,
    "ハラバリー": 45,
    "カイデン": 70,
    "タイカイデン": 125,
    "オラチフ": 51,
    "マフィティフ": 85,
    "シルシュルー": 75,
    "タギングル": 110,
    "アノクサ": 60,
    "アノホラグサ": 90,
    "ノノクラゲ": 70,
    "リククラゲ": 100,
    "ガケガニ": 75,
    "カプサイジ": 50,
    "スコヴィラン": 75,
    "シガロコ": 30,
    "ベラカス": 45,
    "ヒラヒナ": 75,
    "クエスパトラ": 105,
    "カヌチャン": 58,
    "ナカヌチャン": 78,
    "デカヌチャン": 94,
    "ウミディグダ": 95,
    "ウミトリオ": 120,
    "オトシドリ": 82,
    "ナミイルカ": 75,
    "イルカマン\nナイーブフォルム": 100,
    "イルカマン\nマイティフォルム": 100,
    "ブロロン": 47,
    "ブロロローム": 90,
    "モトトカゲ": 121,
    "ミミズズ": 65,
    "キラーメ": 60,
    "キラフロル": 86,
    "ボチ": 34,
    "ハカドッグ": 68,
    "カラミンゴ": 90,
    "アルクジラ": 43,
    "ハルクジラ": 73,
    "ミガルーサ": 70,
    "ヘイラッシャ": 35,
    "シャリタツ": 82,
    "コノヨザル": 90,
    "ドオー": 20,
    "リキキリン": 60,
    "ノココッチ": 55,
    "ドドゲザン": 50,
    "イダイナキバ": 87,
    "サケブシッポ": 111,
    "アラブルタケ": 55,
    "ハバタクカミ": 135,
    "チヲハウハネ": 81,
    "スナノケガワ": 101,
    "テツノワダチ": 106,
    "テツノツツミ": 136,
    "テツノカイナ": 50,
    "テツノコウベ": 108,
    "テツノドクガ": 110,
    "テツノイバラ": 72,
    "セビエ": 55,
    "セゴール": 62,
    "セグレイブ": 87,
    "コレクレー\nはこフォルム": 10,
    "コレクレー\nとほフォルム": 80,
    "サーフゴー": 84,
    "チオンジェン": 70,
    "パオジアン": 135,
    "ディンルー": 45,
    "イーユイ": 100,
    "トドロクツキ": 119,
    "テツノブジン": 116,
    "コライドン": 135,
    "ミライドン": 135,
    "ウネルミナモ": 109,
    "テツノイサハ": 104,
    "カミッチュ": 40,
    "チャデス": 50,
    "ヤバソチャ": 70,
    "イイネイヌ": 80,
    "マシマシラ": 106,
    "キチキギス": 99,
    "オーガポン\nみどりのめん": 110,
    "オーガポン\nいどのめん": 110,
    "オーガポン\nかまどのめん": 110,
    "オーガポン\nいしずえのめん": 110,
    "ブリジュラス": 85,
    "カミツオロチ": 44,
    "ウガツホムラ": 91,
    "タケルライコ": 75,
    "テツノイワオ": 124,
    "テツノカシラ": 98,
    "テラパゴス\nノーマルフォルム": 60,
    "テラパゴス\nテラスタルフォルム": 85,
    "テラパゴス\nステラフォルム": 85,
    "モモワロウ": 88
   };

// ひらがな→カタカナ変換（簡易版）
const hiraToKana = (str) => str.replace(/[\u3041-\u3096]/g, match =>
  String.fromCharCode(match.charCodeAt(0) + 96)
);

// 検索候補表示（相手側のポケモン名入力）
// ひらがな入力にも対応（例：「がぶりあす」でも候補表示）
function showSuggestions() {
  let input = document.getElementById("enemyPokemonInput").value.trim();
  let suggestionBox = document.getElementById("enemySuggestionBox");
  suggestionBox.innerHTML = "";
  if (!input) { calculateSpeed(); return; }
  let katakanaInput = hiraToKana(input);
  let filtered = Object.keys(pokemonData).filter(name => name.includes(katakanaInput));
  filtered.slice(0, 3).forEach(name => {
    let div = document.createElement("div");
    div.textContent = name;
    div.onclick = function () {
      document.getElementById("enemyPokemonInput").value = name;
      suggestionBox.innerHTML = "";
      calculateSpeed();
    };
    suggestionBox.appendChild(div);
  });
  calculateSpeed();
}

// ランク補正乗数（-6～+6）
function rankMultiplier(rank) {
  if (rank > 0) return (2 + rank) / 2;
  if (rank < 0) return 2 / (2 - rank);
  return 1;
}

// ランク調整（共通）
function adjustRank(type, change) {
  if (type === "self") {
    selfRank = Math.max(-6, Math.min(6, selfRank + change));
    document.getElementById("selfRankDisplay").textContent = selfRank;
  } else {
    enemyRank = Math.max(-6, Math.min(6, enemyRank + change));
    document.getElementById("enemyRankDisplay").textContent = enemyRank;
  }
  calculateSpeed();
}

// ボタンのON/OFF切替（activeクラスで色付け）
// 正しくONなら計算に反映、OFFならその影響がなくなる
function toggleButton(id, currentFlag) {
  let newFlag = !currentFlag;
  document.getElementById(id).classList.toggle("active", newFlag);
  return newFlag;
}

// 各種ボタンの切替（相手側）
function toggleEnemyWeather() { 
  enemyWeatherActive = toggleButton("enemyWeatherButton", enemyWeatherActive);
  calculateSpeed();
}
function toggleEnemyParalyze() { 
  enemyParalyzeActive = toggleButton("enemyParalyzeButton", enemyParalyzeActive);
  calculateSpeed();
}

// 各種ボタンの切替（自分側）  
function toggleSelfWeather() { 
  selfWeatherActive = toggleButton("selfWeatherButton", selfWeatherActive);
  calculateSpeed();
}
function toggleScarf() { 
  scarfActive = toggleButton("scarfButton", scarfActive);
  calculateSpeed();
}
function toggleSelfParalyze() { 
  selfParalyzeActive = toggleButton("selfParalyzeButton", selfParalyzeActive);
  calculateSpeed();
}

// 計算処理
function calculateSpeed() {
  // 敵側計算（相手のポケモン名入力、ひらがな対応）
  let enemyName = document.getElementById("enemyPokemonInput").value.trim();
  let enemyKey = hiraToKana(enemyName);
  if (!pokemonData[enemyKey]) { 
    document.getElementById("result").innerHTML = "";
    return;
  }
  let enemyBase = pokemonData[enemyKey] * rankMultiplier(enemyRank);
  if (enemyWeatherActive) enemyBase *= 2;
  if (enemyParalyzeActive) enemyBase *= 0.5;
  
  // 6パターンの敵の素早さ計算
  let enemyResults = {
    "最速スカーフ": Math.floor(enemyBase * 1.5 * 1.1),
    "準速スカーフ": Math.floor(enemyBase * 1.5),
    "最速": Math.floor(enemyBase * 1.1),
    "準速": Math.floor(enemyBase),
    "無振り": Math.floor(enemyBase * 0.9),
    "最遅": Math.floor(enemyBase * 0.5)
  };
  
  // 自分側計算（自分の実数値入力がなくても、敵結果は表示）  
  let selfInput = document.getElementById("selfSpeedInput").value;
  let selfComputed = null;
  if (selfInput !== "") {
    selfComputed = parseFloat(selfInput);
    selfComputed *= rankMultiplier(selfRank);
    if (selfWeatherActive) selfComputed *= 2;
    if (scarfActive) selfComputed *= 1.5;
    if (selfParalyzeActive) selfComputed *= 0.5;
    selfComputed = Math.floor(selfComputed);
  }
  
  // 結果表示：各敵パターンと、（入力されていれば）自分の素早さ
  let resultHTML = "";
  for (let key in enemyResults) {
    let enemyVal = enemyResults[key];
    let bgColor = "transparent";
    if (selfComputed !== null) {
      if (selfComputed > enemyVal) bgColor = "rgba(255, 0, 0, 0.3)";      // 自分が速い → 薄い赤
      else if (selfComputed === enemyVal) bgColor = "rgba(255, 255, 0, 0.3)"; // 同速 → 薄い黄
      else bgColor = "rgba(0, 0, 255, 0.3)";                                // 自分が遅い → 薄い青
    }
    resultHTML += `<div class='result-row' style='background:${bgColor};'>` +
                  `<span>${key}</span><span>${enemyVal}</span></div>`;
  }
  if (selfComputed !== null) {
    resultHTML += `<div class='result-row self-result'>自分の素早さ: ${selfComputed}</div>`;
  }
  document.getElementById("result").innerHTML = resultHTML;
}
